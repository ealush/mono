<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
		<title>handle-rejection | an npm package by omrilotan</title>
		<meta name="description" content="💀 Handle unhandled rejections">
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=yes">
		<link rel="stylesheet" href="../styles.css">
		<link rel="prerender" href="../">
	</head>
	<body>
		<a href="../">↩︎</a>
		<h1 id="handle-rejection">handle-rejection <a href="https://www.npmjs.com/package/handle-rejection"><img src="https://img.shields.io/npm/v/handle-rejection.svg" alt=""></a> <a href="https://github.com/omrilotan/mono/tree/master/packages/handle-rejection"><img src="https://img.shields.io/badge/source--000000.svg?logo=github&style=social" alt=""></a></h1>
<h2 id="💀-handle-unhandled-rejections">💀 Handle unhandled rejections</h2>
<h3 id="built-in-single-handlers">Built in single handlers</h3>
<pre><code class="language-js">require(&#39;handle-rejection&#39;).console(); // console.error(error)</code></pre>
<table>
<thead>
<tr>
<th>Name</th>
<th>Details</th>
</tr>
</thead>
<tbody><tr>
<td>console</td>
<td>console.error</td>
</tr>
<tr>
<td>exit</td>
<td>process.exit</td>
</tr>
<tr>
<td>throw</td>
<td>throws error</td>
</tr>
<tr>
<td>collect</td>
<td>Prints all errors before process exists</td>
</tr>
</tbody></table>
<h3 id="combine-handlers">Combine handlers</h3>
<pre><code class="language-js">require(&#39;handle-rejection&#39;)(
    &#39;console&#39;,
    &#39;collect&#39;
);</code></pre>
<blockquote>
<p>This one is a good combination for long test suits (see below) †</p>
</blockquote>
<h3 id="custom-handlers">Custom handlers</h3>
<pre><code class="language-js">const errobj = require(&#39;errobj&#39;);

require(&#39;handle-rejection&#39;)(
    error =&gt; fetch(
        &#39;/report-error&#39;,
        {
            method: &#39;POST&#39;,
            body: JSON.stringify(errobj(error))
        }
    )
);</code></pre>
<h3 id="combined-handlers-built-in-and-custom">Combined handlers: built in and custom</h3>
<pre><code class="language-js">require(&#39;handle-rejection&#39;)(
    error =&gt; Raven.captureException(error) // custom
    &#39;exit&#39;, // built in
);</code></pre>
<hr>
<blockquote>
<p>† Example for a combination of &quot;console&quot; and &quot;collect&quot; in a testing environment</p>
</blockquote>
<pre><code>&gt; mocha

  some function
    ✓ Should be okay
TypeError: Cannot read property &#39;ok&#39; of undefined
    at ok (/workspace/package/spec.js:21:11)
    at tryCatch (/workspace/package/node_modules/regenerator-runtime/runtime.js:45:40)
    at Generator.invoke [as _invoke] (/workspace/package/node_modules/regenerator-runtime/runtime.js:271:22)
    at Generator.prototype.(anonymous function) [as next] (/workspace/package/node_modules/regenerator-runtime/runtime.js:97:21)
    at asyncGeneratorStep (/workspace/package/spec.js:14:103)
    at _next (/workspace/package/spec.js:16:194)
    at process._tickCallback (internal/process/next_tick.js:68:7)

  some other function
    ✓ Should success
    ✓ Should also success
    ✓ Should really work

  another bulk of tests
    ✓ Should be fine
    ✓ Should pass the test

  6 passing (110ms)

╭─────────────────────────────╮
│ Unhandled Rejection Summary │
╰─────────────────────────────╯

❗️ Rejection 1:
TypeError: Cannot read property &#39;ok&#39; of undefined
    at ok (/workspace/package/spec.js:21:11)
    at tryCatch (/workspace/package/node_modules/regenerator-runtime/runtime.js:45:40)
    at Generator.invoke [as _invoke] (/workspace/package/node_modules/regenerator-runtime/runtime.js:271:22)
    at Generator.prototype.(anonymous function) [as next] (/workspace/package/node_modules/regenerator-runtime/runtime.js:97:21)
    at asyncGeneratorStep (/workspace/package/spec.js:14:103)
    at _next (/workspace/package/spec.js:16:194)
    at process._tickCallback (internal/process/next_tick.js:68:7)</code></pre>
	</body>
</html>
